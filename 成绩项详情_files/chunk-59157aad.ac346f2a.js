(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59157aad"],{"5fb8":function(e,t,n){"use strict";var r=n("cebc"),a=n("5176"),s=n.n(a),c=(n("6762"),n("2fdb"),n("4917"),n("ac6a"),n("795b")),i=n.n(c),u=(n("96cf"),n("3b8d")),o=n("d225"),l=n("b0b4"),h=n("308d"),d=n("6bb5"),p=n("4e2b"),f=n("0fea"),b=n("3fa7"),m=function(e){function t(){return Object(o["a"])(this,t),Object(h["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"enableCreditRequirement",value:function(e){var t=e||f["a"].identity.reflection,n=this.metadata&&"domestic"===this.metadata.college_consideration;return this.constructor.isElectiveInGoal(t)&&n}},{key:"getCollegeGoalSuggestion",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("".concat(this.constructor.baseURL,"/academic-goals/").concat(this.id,"/suggestion"));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"validateGoal",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new i.a(function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(n){var r,a,s,c,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=_.keys(t.metadata),a=_.some(r,function(e){return/major/.test(e)}),s=3===_.get(t.metadata,"subjects.length"),c="",e.t0=t.metadata.college_consideration,e.next="domestic"===e.t0?7:"abroad"===e.t0?16:"not_college"===e.t0?18:20;break;case 7:if(!a||!s){e.next=14;break}return e.next=10,t.getCollegeGoalSuggestion();case 10:i=e.sent,c=i.match?"goal-match":"goal-not-match",e.next=15;break;case 14:c="goal-not-full";case 15:return e.abrupt("break",22);case 16:return c=a?"goal-match":"goal-not-full",e.abrupt("break",22);case 18:return c="goal-match",e.abrupt("break",22);case 20:return c="goal-not-full",e.abrupt("break",22);case 22:n({type:c});case 23:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"isExist",get:function(){return!!this.description}},{key:"goalShow",get:function(){return _.get(this,"additional_descriptions")||{}}}],[{key:"canUse",value:function(e){var t=e||f["a"].identity.reflection,n=[3,21,226,225,133].includes(+t.school_id),r=[2021,2020].includes(+t.graduates_in),a=252===+t.school_id;return a||n&&r}},{key:"isElectiveInGoal",value:function(e){var t=e||f["a"].identity.reflection,n=[3,133].includes(+t.school_id),r="高中部"===t.college_id;return this.canUse(t)&&n&&r}},{key:"parse",value:function(e){return this.parseSubjects(e),s()(e,{type:"academic",assignments:[{label:"选课"}]}),e}},{key:"parseSubjects",value:function(e){if(e.metadata){var t=e.metadata.subjects;t&&(e.subjectLabels=_.chain(this.allSubjects).filter(function(e){return t.includes(e.value)}).map(function(e){return e.label}).value())}}},{key:"saveCollegeGoal",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.put("".concat(this.baseURL,"/academic-goals?expand=metadata,additional_descriptions"),t);case 2:return n=e.sent,e.abrupt("return",new this(this.parse(n)));case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCollegeGoal",value:function(){return this.getStudentGoal(f["a"].reflection.id)}},{key:"getStudentGoal",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$http.get("".concat(this.baseURL,"/students/").concat(t,"/academic-goals"),{params:{expand:"metadata, additional_descriptions"},disableHttpErrorHandler:!0});case 3:return n=e.sent,e.abrupt("return",new this(this.parse(n)));case 7:return e.prev=7,e.t0=e["catch"](0),e.abrupt("return",new this);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCollegeGoalStudents",value:function(e){return this.getJSON("".concat(this.baseURL,"/academic-goals/students"),this.formatQuery(e))}},{key:"getStudentsWidthGoal",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getJSON("".concat(this.baseURL,"/academic-goal/approval-list"),Object(r["a"])({},t,{sort:"-submitted_at"}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getClassSelectionAssignments",value:function(e){var t="/class-selection-assignments";return e&&(t="/class-selection-assignments/student/".concat(e)),this.$http.get("".concat(this.baseURL).concat(t))}},{key:"finishClassSelectionAssignments",value:function(){return this.$http.put("".concat(this.baseURL,"/class-selection-assignments/finish"))}},{key:"controller",get:function(){return"academic-goals"}},{key:"allSubjects",get:function(){return[{label:"思想政治",value:"politics"},{label:"历史",value:"history"},{label:"地理",value:"geography"},{label:"物理",value:"physics"},{label:"化学",value:"chemistry"},{label:"生物",value:"biology"}]}}]),t}(b["a"]);t["a"]=m},b184:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n("5d73"),a=n.n(r),s=(n("96cf"),n("3b8d")),c=n("d225"),i=n("b0b4"),u=n("308d"),o=n("6bb5"),l=n("4e2b"),h=n("3fa7"),d=n("d1b0"),p=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(o["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(i["a"])(t,[{key:"finish",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.status="finished",e.next=3,this.save();case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"start",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.status="started",e.next=3,this.save();case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"statusFlag",get:function(){var e=moment().format("YYYY-MM-DD HH:mm:ss");return e<this.start_at?"upcoming":e<this.end_in?"inProcess":"ended"}},{key:"canReset",get:function(){return moment().isBetween(this.start_at,moment(this.end_in).add(1,"d"))}},{key:"readableTime",get:function(){switch(this.statusFlag){case"upcoming":return"".concat(moment(this.start_at).fromNow(),"开始");case"inProcess":return"".concat(moment(this.end_in).fromNow(),"结束");default:return"已结束于".concat(moment(this.end_in).fromNow())}}},{key:"progress",get:function(){switch(this.statusFlag){case"upcoming":return 0;case"ended":return 1;case"inProcess":var e=moment(this.end_in).diff(this.start_at,"seconds"),t=moment(this.end_in).diff(moment(),"seconds");return((e-t)/e).toFixed(2)}}}],[{key:"isInElection",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.findAll({semester_id:t});case 2:return n=e.sent,e.abrupt("return",n.some(function(e){return"started"===e.status}));case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"findAllBySemesterId",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.findAll({semester_id:t});case 2:return n=e.sent,e.abrupt("return",_.orderBy(n,"start_at","desc"));case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"findCurrentByStudent",value:function(e,t){var n="".concat(this.baseURL,"/students/").concat(e,"/course-elections");return this.getJSON(n,t)}},{key:"findAvailableCourses",value:function(e){var t="".concat(this.baseURL,"/").concat(this.controller,"/").concat(e,"/student-available"),n={expand:["schedules","teacher","teachers","subject","attribute","pending_count","success_count"]};return d["default"].findAll(n,{url:t})}},{key:"togglePause",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r="".concat(this.baseURL,"/semesters/").concat(t,"/selection-statuses"),e.prev=1,e.next=4,this.$http.put(r,{status:n});case 4:"disable"===n?toast.success("暂停选课成功！"):toast.success("继续选课成功！"),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),"disable"===n?toast.error("暂停选课失败！错误码：".concat(e.t0.code)):toast.error("继续选课失败！错误码：".concat(e.t0.code));case 10:case"end":return e.stop()}},e,this,[[1,7]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"copy",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t,n){var r,s,c,i,u,o,l,h,d,p,f;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r="".concat(this.baseURL,"/").concat(this.controller,"/").concat(t,"/copy"),e.prev=1,e.next=4,this.$http.post(r,n);case 4:return s=e.sent,e.next=7,s;case 7:return e.abrupt("return",e.sent);case 10:if(e.prev=10,e.t0=e["catch"](1),422!==e.t0.code){e.next=41;break}return c=[],e.next=16,e.t0.response;case 16:for(i=e.sent,u=!0,o=!1,l=void 0,e.prev=20,h=a()(i);!(u=(d=h.next()).done);u=!0)p=d.value,c.push(p.message);e.next=28;break;case 24:e.prev=24,e.t1=e["catch"](20),o=!0,l=e.t1;case 28:e.prev=28,e.prev=29,u||null==h.return||h.return();case 31:if(e.prev=31,!o){e.next=34;break}throw l;case 34:return e.finish(31);case 35:return e.finish(28);case 36:return f=c.join("\n"),e.next=39,dialog.alert(f,e.t0.title,{confirmButtonText:Vue.t("返回修改")});case 39:e.next=42;break;case 41:throw e.t0;case 42:case"end":return e.stop()}},e,this,[[1,10],[20,24,28,36],[29,,31,35]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n="".concat(this.baseURL,"/").concat(this.controller,"/").concat(t,"/selections"),e.next=3,dialog.confirm("确定重置本轮选课吗（之前的选课结果不会受影响）？");case 3:if(!e.sent){e.next=13;break}return e.prev=4,e.next=7,this.$http.delete(n);case 7:toast.success("重置成功"),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](4),toast.error("重置失败！错误码：".concat(e.t0.code));case 13:case"end":return e.stop()}},e,this,[[4,10]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"Name",get:function(){return"course-elections"}},{key:"controller",get:function(){return"course-elections"}},{key:"STATUS",get:function(){return{started:"started",finished:"finished",pending:"pending",disabled:"disabled"}}}]),t}(h["a"])}}]);