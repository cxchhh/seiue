(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-569c03cd"],{a9fd:function(e,s,t){},bead:function(e,s,t){"use strict";var n=t("a9fd"),a=t.n(n);a.a},c670:function(e,s,t){"use strict";t.r(s);var n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("m-header",{attrs:{title:e.headerTitle}},[t("template",{slot:"right"},[t("div",{staticClass:"icon-wrap",on:{click:function(s){e.showItemsSidebarPopup=!0}}},[t("i",{staticClass:"icon icon-menu"})])])],2),e.dataReady&&e.showEmpty?t("div",{staticClass:"empty-page flex center"},[e._v("该评价项不存在或已被删除")]):e._e(),e.dataReady&&!e.showEmpty?t("router-view",{attrs:{"reflection-id":e.currentReflectionId,assessment:e.assessment,"dimension-scores":e.dimensionScore,"assessment-item-scores":e.assessmentItemScore,"grade-setting":e.gradeSetting}}):e._e(),t("m-popup",{attrs:{"hide-header":!0,show:e.showItemsSidebarPopup,width:"240px",placement:"left"},on:{close:function(s){e.showItemsSidebarPopup=!1}}},[t("template",{slot:"body"},[e.assessment?t("sidebar-items",{attrs:{"route-info":e.routeInfo,assessment:e.assessment,"dimension-scores":e.dimensionScore,"assessment-item-scores":e.assessmentItemScore},on:{change:function(s){e.showItemsSidebarPopup=!1}}}):e._e()],1)],2)],1)},a=[],i=t("cebc"),r=t("795b"),d=t.n(r),o=(t("5df3"),t("768b")),u=(t("96cf"),t("3b8d")),c=(t("ac6a"),t("7514"),t("5fdf")),m=t("0fea"),l=t("aa55"),f=t("3f1e"),h=t("0128"),p={components:{SidebarItems:h["a"]},data:function(){return{assessment:null,routeInfo:null,assessmentItemScore:[],dimensionScore:[],gradeSetting:null,dataReady:!1,showItemsSidebarPopup:!1}},computed:{currentReflectionId:function(){return+this.$route.params.student_id||m["a"].identity.rid},headerTitle:function(){if(!this.routeInfo||!this.assessment)return"";var e,s=_.find(this.routeInfo,["current",!0]);switch(s.name){case"studentClassFinalGrade":return"总成绩";case"studentClassGradeDimension":return _.find(this.assessment.dimensions,["id",s.id]).name;case"studentClassGradeItem":return _.forEach(this.assessment.dimensions,function(t){var n=_.find(t.assessment_items,["id",s.id]);n&&(e=n)}),e?e.name:"数据错误";default:return"数据错误"}},showEmpty:function(){if(!this.assessment)return!0;var e=_.find(this.routeInfo,"current");if("studentClassGradeItem"===e.name){var s=_.flatMap(this.assessment.dimensions,function(e){return e.assessment_items});if(!_.some(s,{id:e.id}))return!0}return!1}},watch:{$route:{handler:function(){var e={final:{name:"studentClassFinalGrade",current:!1},dimension:{name:"studentClassGradeDimension",id:+this.$route.params.id,current:!1},item:{name:"studentClassGradeItem",id:+this.$route.params.id,current:!1}};_.find(e,["name",this.$route.name]).current=!0,this.routeInfo=e},immediate:!0}},created:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var s,t,n,a,r,u,m,h,p,_,I,w;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s=this.$route.params.class_id,t={type:c["default"].TYPE.grade,scope_id:s,scope_type:"class",is_template:0,expand:["dimensions.assessment_items.questions","dimensions.assessment_items.question_usages","dimensions.assessment_items.has_owner_scores","plan"]},e.next=4,c["default"].findAll(t);case 4:if(n=e.sent,n&&n.length){e.next=7;break}return e.abrupt("return");case 7:return this.assessment=n[0],a=l["a"].findAllAssessmentItemsForStudent({studentId:this.currentReflectionId,assessmentId:this.assessment.id}),r=l["a"].findAllDimensionForStudent({studentId:this.currentReflectionId,assessmentId:this.assessment.id}),u=f["b"].findAll({type:f["b"].TYPE.grade}),e.next=13,d.a.all([a,r,u]);case 13:m=e.sent,h=Object(o["a"])(m,3),p=h[0],_=h[1],I=h[2],this.assessmentItemScore=p,this.dimensionScore=_,w={student_student_rank:1,student_class_average_distribution:1,teacher_allow_edit_grade:1,teacher_allow_score_delay:1,teacher_allow_edit_assessment:1},this.gradeSetting=Object(i["a"])({},w,I[0].options),this.dataReady=!0;case 23:case"end":return e.stop()}},e,this)}));function s(){return e.apply(this,arguments)}return s}()},I=p,w=(t("bead"),t("2877")),b=Object(w["a"])(I,n,a,!1,null,"167749d6",null);s["default"]=b.exports}}]);