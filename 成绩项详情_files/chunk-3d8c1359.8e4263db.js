(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["chunk-3d8c1359"], { "0646": function (e, t, s) { }, "0cf2": function (e, t, s) { "use strict"; s.d(t, "a", function () { return l }); var r = s("cebc"), n = s("d225"), a = s("b0b4"), i = s("308d"), c = s("6bb5"), o = s("4e2b"), u = s("3fa7"), l = function (e) { function t() { return Object(n["a"])(this, t), Object(i["a"])(this, Object(c["a"])(t).apply(this, arguments)) } return Object(o["a"])(t, e), Object(a["a"])(t, null, [{ key: "getQuestions", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if (!e.biz_type || !e.biz_id) throw new Error("获取问题接口参数不足"); var s = "".concat(this.baseURL, "/nas/questions"), n = Object(r["a"])({}, t, e); return this.getJSON(s, n) } }]), t }(u["a"]) }, 1410: function (e, t, s) { "use strict"; var r = s("0646"), n = s.n(r); n.a }, "24ea": function (e, t, s) { "use strict"; var r = function () { var e = this, t = e.$createElement, s = e._self._c || t; return s("div", { staticClass: "card" }, [s("div", { staticClass: "card__title flex justify-bottom", on: { click: function (t) { e.unfold = !e.isTeacherEdit && !e.unfold } } }, [s("div", { staticClass: "card__title-name" }, [s("span", [e._v("学生自评")]), e.isTeacherEdit ? s("label", { staticClass: "label label-primary", staticStyle: { "margin-left": "8px" } }, [e._v("教师已录入分数")]) : e._e(), !e.isTeacherEdit && e.isComplete ? s("label", { staticClass: "label label-success", staticStyle: { "margin-left": "8px" } }, [e._v("已自评")]) : e._e(), e.isPublished ? s("label", { staticClass: "label label-default", staticStyle: { "margin-left": "8px" } }, [e._v("已截止")]) : e._e()]), e.isTeacherEdit ? e._e() : s("div", { staticClass: "card__title-btn" }, [s("span", [e._v(e._s(e.unfold ? "收起" : "展开"))]), s("span", { staticClass: "icon", class: e.unfold ? "icon-angle-up" : "icon-angle-down" })])]), s("div", { directives: [{ name: "show", rawName: "v-show", value: e.unfold, expression: "unfold" }], staticClass: "card-block" }, [s("div", { staticClass: "form-group" }, [s("label", { staticClass: "label-control" }, [e._v("得分")]), "score" === e.assessmentItem.scoring_type ? [s("se-input", { staticStyle: { display: "inline-block", width: "200px" }, attrs: { disabled: !e.canEdit }, model: { value: e.selfScore.score, callback: function (t) { e.$set(e.selfScore, "score", t) }, expression: "selfScore.score" } }), s("span", { staticClass: "totalScore" }, [e._v("总分" + e._s(e.assessmentItem.max_score) + "分")])] : s("se-rate", { staticStyle: { display: "inline-block", "vertical-align": "top" }, attrs: { value: "" === e.selfScore.score ? 0 : e.selfScore.score, readonly: !e.canEdit, carry: e.selfScore }, on: { change: e.markStarScore } })], 2), s("div", { staticClass: "form-group remark flex" }, [s("label", { staticClass: "label-control" }, [e._v("评语")]), s("div", { staticClass: "remark-edit flex-1" }, [s("textarea", { directives: [{ name: "model", rawName: "v-model", value: e.selfScore.evaluator_review, expression: "selfScore.evaluator_review" }], staticClass: "remark-edit__description", attrs: { placeholder: "输入自评评语...", disabled: !e.canEdit }, domProps: { value: e.selfScore.evaluator_review }, on: { input: function (t) { t.target.composing || e.$set(e.selfScore, "evaluator_review", t.target.value) } } }), e.canEdit || e.selfScore.attachments.length ? s("div", { staticClass: "remark-edit__files" }, [e.canEdit ? s("p", [s("label", { staticStyle: { "margin-bottom": "0", cursor: "pointer" }, attrs: { for: "item-file-upload" } }, [s("i", { staticClass: "icon icon-paperclip" }), e._v(e._s(e.$t("添加附件")) + "..."), s("input-file", { attrs: { id: "item-file-upload", disabled: !e.canEdit }, on: { "file-change": e.addFile } })], 1)]) : e._e(), s("ul", e._l(e.selfScore.attachments, function (t, r) { return s("li", { staticClass: "files-item flex justify" }, [s("a", { staticClass: "link", attrs: { href: e.fileDownloadLink(t), "data-flag": "attachment" } }, [e._v(e._s(t.name))]), e.canEdit ? s("span", { staticClass: "icon icon-close close", on: { click: function (t) { return e.removeFile(r) } } }) : e._e()]) }), 0)]) : e._e()])])]), s("div", { directives: [{ name: "show", rawName: "v-show", value: e.unfold && e.canEdit, expression: "unfold && canEdit" }], staticClass: "card-vitta" }, [s("se-button", { attrs: { type: "primary" }, on: { click: e.submit } }, [e._v("提交评价")])], 1)]) }, n = [], a = (s("28a5"), s("0a0d")), i = s.n(a), c = (s("a481"), s("96cf"), s("3b8d")), o = (s("6762"), s("7514"), s("9ff1")), u = s("aa55"), l = s("0fea"), d = s("2d92"), h = s("ff55"), f = { components: { InputFile: d["a"], AddSubtractLabel: h["a"] }, props: { assessmentItem: { type: Object, required: !0 }, assessment: { type: Object, required: !0 }, scoreList: { type: Array, required: !0 } }, data: function () { return { currentUser: l["a"].identity, unfold: !0, selfScore: null, selfScores: {} } }, computed: { currentScore: function () { return _.find(this.scoreList, { assessment_item_id: this.assessmentItem.id }) }, isComplete: function () { return !!this.currentScore }, isTeacherEdit: function () { return !!this.isComplete && this.currentUser.rid !== this.currentScore.updated_by }, isPublished: function () { var e = ["submitted", "published"]; return e.includes(this.assessment.status) || e.includes(this.assessmentItem.status) }, canEdit: function () { return !this.isComplete && !this.isPublished } }, watch: { assessmentItem: { immediate: !0, handler: function () { var e = this.assessmentItem.id; this.selfScores[e] || (this.selfScores[e] = { score: 0, evaluator_review: "", attachments: [] }), this.selfScore = this.selfScores[e], this.currentScore ? (this.selfScore.score = this.currentScore.score, this.selfScore.evaluator_review = this.currentScore.evaluator_review, this.selfScore.attachments = this.currentScore.attachments) : "level" === this.assessmentItem.scoring_type ? this.selfScore.score = this.selfScore.score || 0 : this.selfScore.score = this.selfScore.score || "", this.unfold = this.canEdit } } }, methods: { submit: function () { var e = Object(c["a"])(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (!(this.selfScore.score > this.assessmentItem.max_score)) { e.next = 3; break } return toast.error("录入分数超过满分，请修改"), e.abrupt("return"); case 3: return e.next = 5, dialog.confirm("填写后不能修改，确认提交么？"); case 5: if (e.sent) { e.next = 7; break } return e.abrupt("return"); case 7: return e.next = 9, u["a"].createByStudent({ studentId: this.currentUser.rid, assessmentItemId: this.assessmentItem.id }, this.selfScore); case 9: this.unfold = !1, this.assessmentItem.has_owner_scores = !0, this.$router.replace({ query: { _random_: i()() } }); case 12: case "end": return e.stop() } }, e, this) })); function t() { return e.apply(this, arguments) } return t }(), markStarScore: function (e, t) { t.score !== e ? t.score = e : t.score = 0 }, addFile: function () { var e = Object(c["a"])(regeneratorRuntime.mark(function e(t) { var s; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (t) { e.next = 2; break } return e.abrupt("return"); case 2: if (!(this.selfScore.attachments.length >= 5)) { e.next = 5; break } return toast.error("最多上传5个附件哦"), e.abrupt("return"); case 5: if (!(t.size > 20971520)) { e.next = 9; break } toast.error(this.$t("附件大小不能超过20M，请重新上传")), e.next = 13; break; case 9: return e.next = 11, o["a"].upload(t, "attachment"); case 11: s = e.sent, this.selfScore.attachments.push({ name: s.name, hash: s.hash }); case 13: case "end": return e.stop() } }, e, this) })); function t(t) { return e.apply(this, arguments) } return t }(), removeFile: function (e) { this.selfScore.attachments.splice(e, 1) }, fileDownloadLink: function (e) { var t = e.hash, s = t.split("."); return "".concat("https://platform.seiue.com", "/files/").concat(s[0], ".download.").concat(s[1]) } } }, p = f, m = (s("fd2d"), s("2877")), v = Object(m["a"])(p, r, n, !1, null, "4f815aba", null); t["a"] = v.exports }, "29d0": function (e, t, s) { }, "2d92": function (e, t, s) { "use strict"; var r = function () { var e = this, t = e.$createElement, s = e._self._c || t; return s("input", { ref: "fileUpload", class: { "input-file-hidden": e.hidden }, attrs: { id: e.id, type: "file", multiple: e.multiple ? "multiple" : void 0 }, on: { change: e.change } }) }, n = [], a = { props: { id: { type: String, default: "" }, hidden: { type: Boolean, default: !0 }, carry: {}, accept: { type: String, default: "" }, multiple: { type: Boolean, default: !1 } }, computed: { acceptText: function () { switch (this.accept) { case "excel": return "application/vnd.ms-excel,application/vnd.ms-excel,application/vnd.ms-excel,application/vnd.ms-excel,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"; case "image": return "image/gif,image/jp2,image/jpeg,image/png"; default: return "" } } }, methods: { change: function (e) { this.$emit("file-change", this.multiple ? e.target.files : e.target.files[0], this.carry) } } }, i = a, c = (s("98f9"), s("2877")), o = Object(c["a"])(i, r, n, !1, null, null, null); t["a"] = o.exports }, "3da8": function (e, t, s) { "use strict"; var r = function () { var e = this, t = e.$createElement, s = e._self._c || t; return s("div", { staticClass: "card remark" }, [s("div", { staticClass: "card__title" }, [s("strong", [e._v(e._s(e.hasSemesterReport ? "学习能力评价和学业发展建议" : "教师评语"))])]), s("div", { staticClass: "card-block" }, [s("div", { staticClass: "remark__info" }, [s("span", { staticStyle: { "margin-right": "16px", "word-break": "break-word" } }, [e._v(e._s(e.remark))]), e._l(e.attachments, function (t) { return s("a", { staticClass: "link", attrs: { "data-flag": "attachment", href: e.fileDownloadLink(t) } }, [s("span", { staticClass: "icon icon-paperclip", staticStyle: { "margin-right": "4px" } }), s("span", [e._v(e._s(t.name))])]) })], 2)])]) }, n = [], a = (s("28a5"), s("96cf"), s("3b8d")), i = s("ee98"), c = s("0fea"), o = { props: { currentScore: { type: Object, default: null }, finalGrade: { type: Object, default: null } }, data: function () { return { hasSemesterReport: !1 } }, computed: { remark: function () { return this.currentScore ? this.currentScore.evaluator_review : this.finalGrade.review }, attachments: function () { return this.currentScore ? this.currentScore.attachments : this.finalGrade.attachments }, currentKlassId: function () { return this.$route.params.class_id } }, created: function () { this.checkSemesterReport() }, methods: { checkSemesterReport: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return e.next = 2, i["a"].hasSemesterReport(c["a"].reflection.id, this.currentKlassId); case 2: this.hasSemesterReport = e.sent; case 3: case "end": return e.stop() } }, e, this) })); function t() { return e.apply(this, arguments) } return t }(), fileDownloadLink: function (e) { var t = e.hash, s = t.split("."); return "".concat("https://platform.seiue.com", "/files/").concat(s[0], ".download.").concat(s[1]) } } }, u = o, l = (s("70d1"), s("2877")), d = Object(l["a"])(u, r, n, !1, null, "6e8da790", null); t["a"] = d.exports }, 4254: function (e, t, s) { "use strict"; var r = function () { var e = this, t = e.$createElement, s = e._self._c || t; return e.fileList && e.fileList.length ? s("div", { staticClass: "se-file-list", class: { "se-file-list_row": e.isRow } }, e._l(e.fileList, function (t, r) { return s("div", { directives: [{ name: "tooltip-on-clip", rawName: "v-tooltip-on-clip", value: t.name, expression: "file.name" }], key: r, staticClass: "se-file", style: e.itemStyle }, [t ? s("a", { attrs: { "data-flag": "attachment", target: "_blank", href: t.downloadUrl } }, [s("se-icon", { attrs: { name: "attachment-14-14-1" } }), e._v(e._s(t.name))], 1) : e._e()]) }), 0) : e._e() }, n = [], a = s("e814"), i = s.n(a), c = s("43b5"), o = s("434d"), u = s("dad2"), l = { components: { SeIcon: c["a"] }, directives: { TooltipOnClip: u["b"] }, props: { files: { type: Array, default: null }, direction: { type: String, default: "column" } }, computed: { fileList: function () { return this.files ? this.files.map(function (e) { return e instanceof o["a"] ? e : new o["a"](e) }) : null }, isRow: function () { return "row" === this.direction }, itemStyle: function () { var e = this.files.length, t = e && this.isRow ? "".concat(i()(100 / e, 10), "%") : "100%"; return { maxWidth: t } } } }, d = l, h = (s("1410"), s("2877")), f = Object(h["a"])(d, r, n, !1, null, "0dde737a", null), p = f.exports; t["a"] = p }, "434d": function (e, t, s) { "use strict"; s.d(t, "a", function () { return _ }); s("6762"), s("2fdb"), s("28a5"), s("a481"); var r = s("795b"), n = s.n(r), a = (s("96cf"), s("3b8d")), i = s("d225"), c = s("b0b4"), o = s("308d"), u = s("6bb5"), l = s("4e2b"), d = s("62b0"), h = s("95ae"), f = s.n(h), p = s("20d9"), m = s("6620"), v = s("27d1"), b = null, _ = function (e) { function t(e) { var s; Object(i["a"])(this, t), s = Object(o["a"])(this, Object(u["a"])(t).call(this, e)); var r = s.constructor.UPLOAD_STATUS, n = r.uploaded, a = r.init; return e.url || e.hash ? (e.url || (s.url = "".concat(s.constructor.baseURL, "/").concat(s.constructor.controller, "/").concat(e.hash)), s.uploadStatus = n) : s.uploadStatus = a, e.file && (s.size = Object(p["c"])(e.file.size), s.name = e.name || e.file.name, s.base64 = null), s } return Object(l["a"])(t, e), Object(c["a"])(t, [{ key: "compress", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e() { var t, s, r = arguments; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (t = r.length > 0 && void 0 !== r[0] ? r[0] : {}, this.isImage) { e.next = 3; break } throw new Error("仅有图片文件才可被压缩"); case 3: return e.next = 5, this.constructor.compressImage(this.file, t); case 5: return s = e.sent, this.file = s, e.abrupt("return", this); case 8: case "end": return e.stop() } }, e, this) })); function t() { return e.apply(this, arguments) } return t }() }, { key: "toBase64", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return e.next = 2, this.constructor.fileToBase64(this.file); case 2: return this.base64 = e.sent, e.abrupt("return", this); case 4: case "end": return e.stop() } }, e, this) })); function t() { return e.apply(this, arguments) } return t }() }, { key: "upload", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e() { var t, s, r, n, a, i, c = arguments; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (t = c.length > 0 && void 0 !== c[0] ? c[0] : "attachment", s = this.constructor, r = s.UPLOAD_STATUS, n = s.baseURL, a = s.controller, this.uploadStatus !== r.uploading && this.uploadStatus !== r.uploaded) { e.next = 4; break } return e.abrupt("return", this); case 4: return this.uploadStatus = r.uploading, e.prev = 5, e.next = 8, this.constructor.upload(this.file, t); case 8: i = e.sent, this.url = "".concat(n, "/").concat(a, "/").concat(i.hash), this.group = i.group, this.name = i.name, this.hash = i.hash, this.uploadStatus = r.uploaded, e.next = 19; break; case 16: e.prev = 16, e.t0 = e["catch"](5), this.uploadStatus = r.fail; case 19: return e.abrupt("return", this); case 20: case "end": return e.stop() } }, e, this, [[5, 16]]) })); function t() { return e.apply(this, arguments) } return t }() }, { key: "isImage", get: function () { var e = /^image\//; return e.test(this.file.type) } }, { key: "downloadUrl", get: function () { return this.constructor.getDownloadUrl(this) } }], [{ key: "upload", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e(t, s) { var r, n, a; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return r = new FormData, r.append("file", t, t.name), n = "".concat(this.baseURL, "/").concat(this.controller, "?group=").concat(s), e.next = 5, this.$http.post(n, r); case 5: return a = e.sent, e.abrupt("return", a.file); case 7: case "end": return e.stop() } }, e, this) })); function t(t, s) { return e.apply(this, arguments) } return t }() }, { key: "fileToBase64", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e(t) { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return e.abrupt("return", new n.a(function (e, s) { var r = new FileReader; r.readAsDataURL(t), r.onload = function () { e(r.result) }, r.onerror = function (e) { s(e) } })); case 1: case "end": return e.stop() } }, e) })); function t(t) { return e.apply(this, arguments) } return t }() }, { key: "compressImage", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e(t) { var s, r, n = arguments; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return s = n.length > 1 && void 0 !== n[1] ? n[1] : {}, f()(s, { maxWidth: 1600, checkOrientation: !1 }), b = b || new d["a"], e.next = 5, b.compress(t, s); case 5: return r = e.sent, e.abrupt("return", r); case 7: case "end": return e.stop() } }, e) })); function t(t) { return e.apply(this, arguments) } return t }() }, { key: "getDownloadUrl", value: function (e) { var t = e.url, s = e.name; if (/.download.\w+$/i.test(t) || (t = t.replace(/(.\w+)$/i, function (e, t) { return ".download".concat(t) })), v["a"].isCichu && e.name) { var r = t.split("?")[1] || ""; if (r.includes("filename=")) return t; var n = "filename=".concat(encodeURI(s)); n = r ? "&".concat(n) : "?".concat(n), t += n } return t } }, { key: "baseURL", get: function () { return "https://platform.seiue.com" } }, { key: "controller", get: function () { return "files" } }, { key: "UPLOAD_STATUS", get: function () { return { init: "init", uploading: "uploading", fail: "fail", uploaded: "uploaded" } } }]), t }(m["a"]) }, "47f1": function (e, t, s) { }, "70d1": function (e, t, s) { "use strict"; var r = s("47f1"), n = s.n(r); n.a }, 9601: function (e, t, s) { "use strict"; var r = function () { var e = this, t = e.$createElement, s = e._self._c || t; return e.scoreLogs && e.scoreLogs.length ? s("div", { staticClass: "mark-log card" }, [s("div", { staticClass: "card__title" }, [e._v("分数录入记录\n(共" + e._s(e.scoreLogs.length) + "项)")]), s("div", { staticClass: "mark-log-list card-block" }, [e._l(e.scoreLogs, function (t, r) { return [s("div", { directives: [{ name: "show", rawName: "v-show", value: !!e.unfold || r < 3, expression: "unfold ? true : index < 3" }], staticClass: "mark-log-list__item flex justify" }, [e.isFluctuation ? [s("div", { staticClass: "mark-log-list__item-result" }, [t.isDefault ? s("label", { staticClass: "label label-primary" }, [e._v(e._s(t.item_score))]) : s("label", { staticClass: "label", class: t.item_score > 0 ? "label-success" : "label-danger" }, [e._v(e._s(t.item_score > 0 ? "+" + t.item_score : t.item_score))])]), s("div", { staticClass: "mark-log-list__item-reason flex-1", staticStyle: { width: "0" } }, [s("div", { staticClass: "tag-name" }, [e._v(e._s(e.tagName(t)))]), e.existRemark(t) ? s("div", { staticClass: "remark" }, [s("strong", [e._v("老师留言：")]), s("div", { staticClass: "remark-content" }, [s("span", [e._v(e._s(t.evaluator_review))])])]) : e._e(), s("se-file-list", { attrs: { files: t.attachments, direction: "row" } })], 1), s("div", { staticClass: "mark-log-list__item-info" }, [t.isDefault || e.isAttendanceDimension ? e._e() : s("div", { staticClass: "mark-log-list__item-info-operator" }, [e._v("录入者: " + e._s(t.evaluator && t.evaluator.name) + "老师")]), s("div", { staticClass: "mark-log-list__item-info-time" }, [e._v(e._s(e.formatData(t)))])])] : [s("div", { staticClass: "mark-log-list__item-result" }, ["score" === e.assessmentItem.option_display ? [s("label", { staticClass: "label label-primary" }, [e._v(e._s(t.score))])] : e._e(), "level" === e.assessmentItem.option_display ? [s("se-rate", { attrs: { value: t.score, readonly: "" } })] : e._e()], 2), s("div", { staticClass: "mark-log-list__item-reason flex-1", staticStyle: { width: "0" } }, [e.existRemark(t) ? s("div", { staticClass: "remark" }, [s("strong", [e._v("老师留言：")]), s("div", { staticClass: "remark-content" }, [e._v(e._s(t.evaluator_review))])]) : e._e(), s("se-file-list", { attrs: { files: t.attachments, direction: "row" } })], 1), s("div", { staticClass: "mark-log-list__item-info" }, [s("div", { staticClass: "mark-log-list__item-info-operator" }, [e._v("录入者: " + e._s(t.evaluator && t.evaluator.name) + "老师")]), s("div", { staticClass: "mark-log-list__item-info-time" }, [e._v(e._s(e._f("filterDate")(t.updated_at)))])])]], 2)] })], 2), e.scoreLogs.length > 3 ? s("div", { staticClass: "mark-log__unfold flex left", on: { click: function (t) { e.unfold = !e.unfold } } }, [s("div", { staticClass: "unfold-button" }, [s("span", [e._v(e._s(e.unfold ? "收起" : "展开"))]), s("span", { staticClass: "icon", class: e.unfold ? "icon-angle-up" : "icon-angle-down" })])]) : e._e()]) : e._e() }, n = [], a = (s("7514"), s("e814")), i = s.n(a), c = (s("28a5"), s("768b")), o = (s("96cf"), s("3b8d")), u = s("170a"), l = s("5bf1"), d = s("4254"), h = { components: { SeFileList: d["a"] }, mixins: [l["a"]], props: { assessmentItem: { type: Object, required: !0 }, scoreDetails: { type: Array, required: !0 }, currentDimension: { type: Object, required: !0 } }, data: function () { return { unfold: !1, semesters: [] } }, computed: { isFluctuation: function () { return !!this.assessmentItem && "score_item" === this.assessmentItem.scoring_type }, isAttendanceDimension: function () { return this.currentDimension && "attendance" === this.currentDimension.type }, scoreLogs: function () { if (this.isFluctuation) { var e = _.flatten(_.map(this.scoreDetails, function (e) { return e.score_items })), t = _.reverse(_.sortBy(e, "created_at")); return t.push({ created_at: this.assessmentItem.created_at, evaluator: "", item_score: this.assessmentItem.default_score, item_score_remark: "成绩项建立，初始得分为".concat(this.assessmentItem.default_score, "分"), isDefault: !0 }), t } return this.scoreDetails } }, created: function () { var e = Object(o["a"])(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return e.next = 2, u["default"].findAll(); case 2: this.semesters = e.sent; case 3: case "end": return e.stop() } }, e, this) })); function t() { return e.apply(this, arguments) } return t }(), methods: { existRemark: function (e) { return this.isAttendanceDimension ? null : this.isFluctuation ? e.evaluator_review : e.evaluator_review || !_.isEmpty(e.attachments) }, formatData: function (e) { if (!e.item_score_time) return ""; var t = e.item_score_time.split(":"), s = Object(c["a"])(t, 2), r = s[0], n = s[1]; if (0 === i()(n, 10)) return r; var a = _.find(this.semesters, function (e) { return e.start_at <= r && e.end_in >= r }), o = this.transformLesson(n, a); return "".concat(r, " ").concat(o) }, tagName: function (e) { var t = e.item_score_remark; if (!this.isAttendanceDimension || e.isDefault) return t; var s = _.keyBy(this.assessmentItem.tags, "result"); return s[t] && s[t].name } } }, f = h, p = (s("e393"), s("2877")), m = Object(p["a"])(f, r, n, !1, null, "eb3fff1a", null); t["a"] = m.exports }, "98f9": function (e, t, s) { "use strict"; var r = s("29d0"), n = s.n(r); n.a }, "9ff1": function (e, t, s) { "use strict"; s.d(t, "a", function () { return p }); var r = s("795b"), n = s.n(r), a = (s("96cf"), s("3b8d")), i = s("d225"), c = s("b0b4"), o = s("308d"), u = s("6bb5"), l = s("4e2b"), d = s("3fa7"), h = s("62b0"), f = new h["a"], p = function (e) { function t(e) { var s; return Object(i["a"])(this, t), s = Object(o["a"])(this, Object(u["a"])(t).call(this, e)), e.url ? s.uploadStatus = s.constructor.UPLOAD_STATUS.uploaded : s.uploadStatus = s.constructor.UPLOAD_STATUS.init, s.file && (s.name = s.file.name), s } return Object(l["a"])(t, e), Object(c["a"])(t, [{ key: "compress", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e() { var t, s, r = arguments; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (t = r.length > 0 && void 0 !== r[0] ? r[0] : {}, this.isImage) { e.next = 3; break } throw new Error("仅有图片文件才可被压缩"); case 3: return e.next = 5, this.constructor.compressImage(this.file, t); case 5: return s = e.sent, this.file = s, e.abrupt("return", this); case 8: case "end": return e.stop() } }, e, this) })); function t() { return e.apply(this, arguments) } return t }() }, { key: "getBase64", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e() { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return e.next = 2, this.constructor.fileToBase64(this.file); case 2: return this.base64 = e.sent, e.abrupt("return", this); case 4: case "end": return e.stop() } }, e, this) })); function t() { return e.apply(this, arguments) } return t }() }, { key: "upload", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e() { var t, s, r, n = arguments; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (t = n.length > 0 && void 0 !== n[0] ? n[0] : "attachment", s = this.constructor.UPLOAD_STATUS, this.uploadStatus !== s.uploading && this.uploadStatus !== s.uploaded) { e.next = 4; break } return e.abrupt("return", this); case 4: return this.uploadStatus = s.uploading, e.prev = 5, e.next = 8, this.constructor.upload(this.file, t); case 8: return r = e.sent, this.url = "".concat(this.constructor.baseURL, "/").concat(this.constructor.controller, "/").concat(r.hash), this.group = r.group, this.name = r.name, this.uploadStatus = s.uploaded, e.abrupt("return", this); case 16: throw e.prev = 16, e.t0 = e["catch"](5), this.uploadStatus = s.fail, e.t0; case 20: case "end": return e.stop() } }, e, this, [[5, 16]]) })); function t() { return e.apply(this, arguments) } return t }() }, { key: "isImage", get: function () { var e = /^image\//; return e.test(this.file.type) } }], [{ key: "upload", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e(t, s) { var r, n, a; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (t) { e.next = 2; break } throw new Error("[File.upload] unknown file"); case 2: return r = new FormData, r.append("file", t, t.name), n = "".concat(this.baseURL, "/").concat(this.controller, "?group=").concat(s), e.prev = 5, e.next = 8, this.$http.post(n, r); case 8: return a = e.sent, e.abrupt("return", a.file); case 12: throw e.prev = 12, e.t0 = e["catch"](5), window.$isMobileApp ? dialog.alert("上传失败", e.t0.message) : dialog.error("上传失败", e.t0.message), e.t0; case 16: case "end": return e.stop() } }, e, this, [[5, 12]]) })); function t(t, s) { return e.apply(this, arguments) } return t }() }, { key: "fileToBase64", value: function () { var e = Object(a["a"])(regeneratorRuntime.mark(function e(t) { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return e.abrupt("return", new n.a(function (e, s) { var r = new FileReader; r.readAsDataURL(t), r.onload = function () { e(r.result) }, r.onerror = function (e) { s(e) } })); case 1: case "end": return e.stop() } }, e) })); function t(t) { return e.apply(this, arguments) } return t }() }, { key: "compressImage", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return _.defaults(t, { maxWidth: 1600, checkOrientation: !1 }), f.compress(e, t) } }, { key: "baseURL", get: function () { return "https://platform.seiue.com" } }, { key: "controller", get: function () { return "files" } }, { key: "UPLOAD_STATUS", get: function () { return { init: "init", uploading: "uploading", fail: "fail", uploaded: "uploaded" } } }]), t }(d["a"]) }, aa55: function (e, t, s) { "use strict"; s.d(t, "a", function () { return h }); var r = s("cebc"), n = (s("96cf"), s("3b8d")), a = s("d225"), i = s("308d"), c = s("6bb5"), o = s("b0b4"), u = s("4e2b"), l = s("3fa7"), d = s("888c"), h = function (e) { function t() { var e, s; Object(a["a"])(this, t); for (var r = arguments.length, n = new Array(r), o = 0; o < r; o++)n[o] = arguments[o]; return s = Object(i["a"])(this, (e = Object(c["a"])(t)).call.apply(e, [this].concat(n))), s.oldScore = void 0 === s.oldScore ? s.score : s.oldScore, s } return Object(u["a"])(t, e), Object(o["a"])(t, null, [{ key: "NAME", get: function () { return "Score" } }, { key: "controller", get: function () { return "nas/scores" } }]), Object(o["a"])(t, [{ key: "isChanged", get: function () { return this.score !== this.oldScore || this.delayed !== this.oldDelayed || this.delayed_reason !== this.oldDelayedReason || this.evaluator_review !== this.oldEvaluatorReview || !_.isEqual(this.attachments, this.oldAttachments) } }, { key: "isChangedExceptScore", get: function () { return this.delayed !== this.oldDelayed || this.delayed_reason !== this.oldDelayedReason || this.evaluator_review !== this.oldEvaluatorReview || !_.isEqual(this.attachments, this.oldAttachments) } }, { key: "isScoreDirty", get: function () { var e = function (e) { return "" === e || null == e }; return (!e(this.oldScore) || !e(this.score)) && (!(!e(this.oldScore) || e(this.score)) || (!(e(this.oldScore) || !e(this.score)) || Math.abs(+this.score - +this.oldScore) >= .01)) } }], [{ key: "batchCreate", value: function (e) { if (!_.isArray(e) || !e.length) return null; var t = "".concat(this.baseURL, "/").concat(this.controller, "/$batch"); return this.$http.post(t, e) } }, { key: "batchUpdate", value: function (e) { if (!_.isArray(e) || !e.length) return null; var t = "".concat(this.baseURL, "/").concat(this.controller, "/$batch"); return this.$http.put(t, e) } }, { key: "batchSave", value: function () { var e = Object(n["a"])(regeneratorRuntime.mark(function e(t) { var s; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: return s = "".concat(this.baseURL, "/").concat(this.controller, "/v2/$batch"), e.abrupt("return", this.$http.put(s, t)); case 2: case "end": return e.stop() } }, e, this) })); function t(t) { return e.apply(this, arguments) } return t }() }, { key: "findAllAssessmentItemScore", value: function (e) { var t = "".concat(this.baseURL, "/nas/assessment-item-scores"); return this.findAll(e, { url: t }) } }, { key: "findAllDimensionScore", value: function (e) { var t = "".concat(this.baseURL, "/nas/dimension-scores"); return this.findAll(e, { url: t }) } }, { key: "findAllForStudentAndAssessment", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, s = "".concat(this.baseURL, "/nas/students/").concat(e.studentId, "/assessments/").concat(e.assessmentId, "/scores"), n = Object(r["a"])({ "per-page": 99999 }, t); return this.findAll(n, { url: s }) } }, { key: "findAllAssessmentItemsForStudent", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, s = "".concat(this.baseURL, "/nas/students/").concat(e.studentId, "/assessments/").concat(e.assessmentId, "/assessment-item-scores"), n = Object(r["a"])({ "per-page": 99999 }, t); return this.findAll(n, { url: s }) } }, { key: "findAllDimensionForStudent", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, s = "".concat(this.baseURL, "/nas/students/").concat(e.studentId, "/assessments/").concat(e.assessmentId, "/dimension-scores"), n = Object(r["a"])({ "per-page": 99999 }, t); return this.findAll(n, { url: s }) } }, { key: "findAllForMoralAssessment", value: function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, s = "".concat(this.baseURL, "/nas/moral-assessments/").concat(e, "/scores"); return this.findAll(d["a"].formatQuery(t, "reflection."), { url: s }) } }, { key: "createByStudent", value: function (e, t) { var s = e.studentId, r = e.assessmentItemId, n = "".concat(this.baseURL, "/nas/students/").concat(s, "/assessment-items/").concat(r, "/self-assessment-scores"); return this.$http.post(n, t) } }, { key: "batchUpdateItems", value: function (e) { if (!_.isArray(e) || !e.length) return null; var t = "".concat(this.baseURL, "/nas/score-items/$batch"); return this.$http.post(t, e) } }, { key: "batchDeleteItems", value: function (e) { if (!e) return null; var t = "".concat(this.baseURL, "/nas/score-items/$batch"), s = { id: e }; return this.$http.delete(t, { data: s }) } }, { key: "markTeacherRead", value: function (e) { if (!_.isArray(e) || !e.length) return null; var t = "".concat(this.baseURL, "/").concat(this.controller, "/teacher-views/$batch"); return this.$http.put(t, e) } }, { key: "markStudentRead", value: function (e) { if (!_.isArray(e) || !e.length) return null; var t = "".concat(this.baseURL, "/").concat(this.controller, "/student-views/$batch"); return this.$http.put(t, e) } }, { key: "inputPeriodicFeedback", value: function (e, t) { var s = e.studentId, r = e.assessmentItemId, n = "".concat(this.baseURL, "/nas/students/").concat(s, "/assessment-items/").concat(r, "/question-score-items/$batch"); return this.$http.post(n, t) } }, { key: "getAbnormalStats", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return this.$http.post("".concat(this.baseURL, "/").concat(this.controller, "/abnormal-stats/$query"), e) } }, { key: "findScoresForStudent", value: function (e, t) { return this.findAll(t, { url: "".concat(this.baseURL, "/nas/students/").concat(e, "/scores") }) } }]), t }(l["a"]) }, d392: function (e, t, s) { }, d755: function (e, t, s) { "use strict"; var r = s("d392"), n = s.n(r); n.a }, e393: function (e, t, s) { "use strict"; var r = s("eef2"), n = s.n(r); n.a }, ee98: function (e, t, s) { "use strict"; s.d(t, "a", function () { return p }); s("96cf"); var r = s("3b8d"), n = (s("6762"), s("2fdb"), s("d225")), a = s("b0b4"), i = s("308d"), c = s("6bb5"), o = s("4e2b"), u = s("0cf2"), l = [336732, 336737, 336733, 336734, 336738, 336735, 336736, 336739, 336749, 346177, 336750, 336752, 336751, 336757, 336753, 336754, 336395, 336397, 336403, 336387, 336388, 336389, 336390, 336404, 336405, 336406, 336413, 336414, 336427, 336428, 336429, 336430, 336415, 336416, 338609, 336420, 336421, 336422, 336396, 336398, 336285, 336443, 336286, 336444, 336287, 336445, 336288, 336446, 336293, 336435, 336436, 336294, 336437, 336295, 336438, 336296, 336695, 336696, 336692, 336693, 336697, 336698, 336694, 336700, 336713, 336721, 336717, 336722, 336714, 336723, 336718, 336715, 336724, 336719, 336716, 336720, 336505, 336506, 336507, 336508, 336513, 336514, 336515, 336516, 336529, 336530, 336531, 336532, 336537, 336538, 336539, 336521, 336522, 336523, 336524, 336540, 336561, 336565, 336569, 336557, 336570, 336558, 336566, 336562, 336567, 336563, 336571, 336559, 336568, 336560, 336564, 336572, 336770, 336773, 336766, 336767, 336771, 336772, 336768, 336774, 336769, 336782, 336786, 336783, 336784, 336787, 336785, 336301, 336309, 336310, 336302, 336303, 336311, 336312, 336304, 336326, 336327, 336317, 336318, 336328, 336319, 336320, 336329, 336330, 336331, 336332, 336333, 336334, 336335, 336336, 336337, 336338, 336621, 336629, 336625, 336630, 336626, 336622, 336631, 336627, 336628, 336623, 336624, 336632, 336591, 336595, 336587, 336588, 336592, 336596, 336597, 336600, 336598, 336589, 336599, 336593, 363628, 336590, 336594, 336633, 336634, 336635, 336636, 338613, 336637, 336638, 336639, 336640, 336652, 336648, 336649, 336653, 365059, 336654, 336650, 336651, 336682, 336670, 336681, 336674, 336671, 336677, 336678, 336672, 336673, 336675, 336679, 336676, 336680, 336684, 339401, 339402, 336374, 339403, 346832, 336350, 336355, 336356, 336363, 336364, 336357, 336365, 336358, 365058, 336366, 336372, 336373, 336375, 336381, 336380, 336382, 336383, 336478, 336473, 336474, 336475, 336489, 336490, 336498, 336499, 336500, 336469, 336470, 336472, 336467, 336468, 336487, 336488, 336486, 336495, 336496, 336497, 336452, 336453, 336454, 336455, 336450, 336451, 336483, 336481, 336482, 350088, 336458, 336459, 336460, 336461, 336463, 336464, 336462, 336465, 336484, 336485, 336367, 338611, 336476, 336480], d = [390817, 390870, 390935, 390989, 391049, 391109, 391168, 391284, 390812, 390813, 390929, 390983, 391103, 391158, 391159, 391221, 392015, 391274, 391275, 391004, 391066, 391300, 390780, 390843, 390851, 390787, 391019, 390972, 391143, 390967, 391084, 391202, 390904, 391016, 391135, 391248, 390847, 390901, 391141, 391208, 390773, 390889, 391013, 391009, 391128, 390771, 390887, 391122, 391238, 390891, 390892, 390957, 391005, 391073, 391124, 391193, 391240, 391301, 390793, 391025, 390804, 390861, 390920, 390921, 391037, 391038, 391095, 391150, 391151, 391266, 391267, 390956, 390837, 391185, 391114, 391063, 390830, 390948, 391059, 391179, 390950, 390996, 391113, 391180, 390832, 391231, 391296, 390831, 390949, 391060, 391295, 391062, 391164, 391280, 390798, 390799, 390857, 390858, 390915, 390975, 391854, 391030, 391091, 391092, 391147, 391211, 391260, 391261, 390820, 390938, 390991, 391051, 391170, 391192, 391286, 390795, 390913, 391853, 391088, 390987, 391044, 391163, 391277, 390789, 390853, 390907, 391021, 391086, 391204, 391137, 391251, 390792, 390910, 391140, 391304, 390823, 390824, 390873, 390874, 390941, 390942, 390992, 391054, 391111, 391173, 391174, 391228, 391229, 391289, 391290, 390865, 390930, 390984, 391105, 391160, 390802, 390803, 390918, 390919, 390979, 391035, 391036, 391094, 391149, 391215, 391264, 391265, 390955, 391181, 391297, 390835, 391003, 390826, 390876, 390944, 390994, 391121, 391056, 391176, 391292, 390808, 390809, 390864, 390926, 390927, 390981, 391042, 391099, 391100, 391155, 391271, 391184, 391299, 390833, 390951, 391311, 391067, 390785, 390849, 390965, 390905, 391017, 391082, 391119, 391136, 391249, 390775, 390895, 390961, 391007, 391076, 391126, 391195, 391242], h = [382560, 390769, 390772, 390774, 390776, 390781, 390786, 390788, 390790, 390791, 390794, 390796, 390797, 390800, 390801, 390805, 390806, 390807, 390810, 390811, 390814, 390815, 390816, 390818, 390819, 390821, 390825, 390827, 390828, 390829, 390833, 390834, 390835, 390837, 390840, 390844, 390848, 390850, 390852, 390854, 390855, 390856, 390862, 390863, 390867, 390868, 390869, 390871, 390875, 390884, 390888, 390890, 390893, 390894, 390896, 390902, 390903, 390906, 390908, 390909, 390914, 390916, 390917, 390922, 390923, 390924, 390925, 390928, 390932, 390933, 390934, 390936, 390937, 390939, 390943, 390945, 390946, 390947, 390951, 390953, 390954, 390956, 390958, 390962, 390966, 390968, 390969, 390973, 390974, 390978, 390980, 390982, 390986, 390988, 390990, 390993, 390995, 391001, 391002, 391003, 391004, 391006, 391008, 391011, 391014, 391015, 391018, 391020, 391022, 391023, 391026, 391029, 391033, 391034, 391039, 391040, 391041, 391043, 391047, 391048, 391050, 391052, 391055, 391057, 391058, 391061, 391063, 391064, 391066, 391072, 391074, 391077, 391083, 391085, 391087, 391089, 391090, 391093, 391096, 391097, 391098, 391101, 391102, 391107, 391108, 391110, 391112, 391114, 391117, 391118, 391120, 391125, 391127, 391130, 391134, 391138, 391139, 391142, 391144, 391145, 391146, 391148, 391152, 391153, 391154, 391156, 391157, 391162, 391165, 391166, 391167, 391169, 391171, 391175, 391177, 391178, 391181, 391182, 391183, 391185, 391191, 391194, 391196, 391203, 391205, 391209, 391210, 391214, 391217, 391218, 391220, 391224, 391225, 391226, 391230, 391241, 391243, 391247, 391252, 391257, 391258, 391259, 391262, 391263, 391268, 391269, 391270, 391272, 391273, 391276, 391281, 391282, 391283, 391285, 391287, 391291, 391293, 391294, 391297, 391298, 391300, 391302, 391303, 391305, 391308, 391311, 391855, 390955], f = [].concat(l, d, h), p = function (e) { function t() { return Object(n["a"])(this, t), Object(i["a"])(this, Object(c["a"])(t).apply(this, arguments)) } return Object(o["a"])(t, e), Object(a["a"])(t, null, [{ key: "getAnswers", value: function (e, t) { var s = "".concat(this.baseURL, "/").concat(this.controller, "/").concat(e, "/question-answers"); return this.getJSON(s, t) } }, { key: "submitAnswers", value: function (e, t) { var s = "".concat(this.baseURL, "/").concat(this.controller, "/").concat(e, "/question-answers/$batch"); return this.$http.post(s, t) } }, { key: "getResourceOfReportByClassId", value: function (e, t) { var s = "".concat(this.baseURL, "/nas/students/").concat(e, "/classes/").concat(t, "/exam-reports"); return this.getJSON(s) } }, { key: "getResourceOfReportBySemesterId", value: function (e, t) { var s = "".concat(this.baseURL, "/nas/students/").concat(e, "/semesters/").concat(t, "/exam-reports"); return this.getJSON(s) } }, { key: "getResourceOfReport", value: function (e, t, s) { var r = ""; if (1 === s) r = 10; else { if (2 !== s) throw new Error("[getResourceOfReport] unknown semester part"); r = 20 } var n = "".concat(this.baseURL, "/nas/students/").concat(e, "/semesters/").concat(t, "-").concat(r, "/exam-reports"); return this.getJSON(n) } }, { key: "isSemesterReportClass", value: function (e) { return f.includes(e) } }, { key: "hasSemesterReport", value: function () { var e = Object(r["a"])(regeneratorRuntime.mark(function e(t, s) { var r; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0: if (!this.isSemesterReportClass(s)) { e.next = 2; break } return e.abrupt("return", !0); case 2: return e.prev = 2, e.next = 5, this.getResourceOfReport(t, 2407, 1); case 5: return r = e.sent, e.abrupt("return", r); case 9: return e.prev = 9, e.t0 = e["catch"](2), e.abrupt("return", !1); case 12: case "end": return e.stop() } }, e, this, [[2, 9]]) })); function t(t, s) { return e.apply(this, arguments) } return t }() }, { key: "controller", get: function () { return "nas/semester-reports" } }, { key: "TYPE", get: function () { return "semester_report" } }]), t }(u["a"]) }, eef2: function (e, t, s) { }, f48f: function (e, t, s) { }, fd2d: function (e, t, s) { "use strict"; var r = s("f48f"), n = s.n(r); n.a }, ff55: function (e, t, s) { "use strict"; var r = function () { var e = this, t = e.$createElement, s = e._self._c || t; return s("label", { staticClass: "add-subtract-label", class: e.labelClass, style: { cursor: e.allowChecked ? "pointer" : "default" }, on: { click: function (t) { return t.stopPropagation(), e.checked() } } }, [s("strong", [e._v(e._s(e.type) + e._s(e.innerScore) + e._s(e.$t("分")))]), s("span", { staticClass: "add-subtract-label__text" }, [e._v(e._s(e.name))]), e.showRemove ? s("i", { staticClass: "icon icon-close-f add-subtract-label__remove", on: { click: function (t) { return t.stopPropagation(), e.$emit("remove", e.carry) } } }) : e._e()]) }, n = [], a = s("59ad"), i = s.n(a), c = (s("c5f6"), { props: { score: { type: [Number, String], required: !0 }, name: { type: String, required: !0 }, showRemove: { type: Boolean, default: !1 }, allowChecked: { type: Boolean, default: !1 }, repeatClick: { type: Boolean, default: !0 }, carry: { type: null, default: null } }, computed: { type: function () { return i()(this.innerScore) < 0 ? "" : "+" }, labelClass: function () { return "add-subtract-label_".concat("+" === this.type ? "add" : "subtract") }, innerScore: function () { return _.round(i()(this.score), 1) } }, methods: { checked: function () { if (this.allowChecked) if (this.repeatClick) this.$emit("checked", this.carry); else { var e = this.$el.classList.contains("checked"); e ? (this.$el.classList.remove("checked"), this.$emit("unchecked", this.carry)) : (this.$el.classList.add("checked"), this.$emit("checked", this.carry)) } } } }), o = c, u = (s("d755"), s("2877")), l = Object(u["a"])(o, r, n, !1, null, "1ae61dac", null); t["a"] = l.exports } }]);